CREATE DATABASE testeGIC;

CREATE TABLE USUARIO (
    ID_USUARIO INT PRIMARY KEY,
    ID_LOJA INT NOT NULL,
    USERNAME VARCHAR(20) UNIQUE NOT NULL,
    NOME VARCHAR(84) NOT NULL
);

CREATE TABLE TAREFA (
    ID_TAREFA INT PRIMARY KEY,
    ID_LOJA INT NOT NULL,
    ID_USUARIO INT NOT NULL,
    SITUACAO SMALLINT NOT NULL,
    DATA_HORA TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    TIPO SMALLINT NOT NULL,
    FOREIGN KEY (ID_USUARIO) REFERENCES USUARIO(ID_USUARIO)
);

CREATE TABLE HISTORICO (
    ID_HISTORICO SERIAL PRIMARY KEY,
    ID_TAREFA INT NOT NULL,
    ID_LOJA INT NOT NULL,
    DATA_HORA TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    TIPO SMALLINT NOT NULL,
    ID_USUARIO INT NOT NULL,
    FOREIGN KEY (ID_TAREFA) REFERENCES TAREFA(ID_TAREFA),
    FOREIGN KEY (ID_USUARIO) REFERENCES USUARIO(ID_USUARIO)
);

CREATE TABLE RESSUPRIMENTO (
    ID_TAREFA INT PRIMARY KEY,
    ID_LOJA INT NOT NULL,
    ID_PRODUTO INT NOT NULL,
    FOREIGN KEY (ID_TAREFA) REFERENCES TAREFA(ID_TAREFA)
);

INSERT INTO USUARIO (ID_USUARIO, ID_LOJA, USERNAME, NOME) VALUES
(1, 101, 'user1', 'Carlos Silva'),
(2, 102, 'user2', 'Ana Souza'),
(3, 103, 'user3', 'Roberto Lima'),
(4, 104, 'user4', 'Mariana Alves'),
(5, 105, 'user5', 'Fernando Rocha'),
(6, 106, 'user6', 'Beatriz Mendes');

INSERT INTO TAREFA (ID_TAREFA, ID_LOJA, ID_USUARIO, SITUACAO, TIPO) VALUES
(1001, 101, 1, 1, 1),
(1002, 101, 1, 2, 2),
(1003, 102, 2, 4, 4),
(1004, 102, 2, 8, 8),
(1005, 103, 3, 9, 9),
(1006, 101, 1, 1, 1),
(1007, 102, 2, 1, 3),
(1008, 103, 3, 2, 2),
(1009, 104, 4, 2, 4),
(1010, 105, 5, 3, 3),
(1011, 106, 6, 3, 5),
(1012, 101, 1, 4, 1),
(1013, 102, 2, 4, 6),
(1014, 103, 3, 5, 7),
(1015, 104, 4, 5, 8),
(1016, 105, 5, 6, 6),
(1017, 106, 6, 6, 9),
(1018, 101, 1, 7, 2),
(1019, 102, 2, 7, 4),
(1020, 103, 3, 8, 8),
(1021, 104, 4, 8, 10),
(1022, 105, 5, 9, 9),
(1023, 106, 6, 9, 7),
(1024, 101, 1, 10, 5),
(1025, 102, 2, 10, 3);

INSERT INTO HISTORICO (ID_TAREFA, ID_LOJA, TIPO, ID_USUARIO) VALUES
(1001, 101, 1, 1),
(1001, 101, 2, 1),
(1002, 101, 3, 1),
(1003, 102, 6, 2),
(1004, 102, 8, 2),
(1005, 103, 9, 3),
(1006, 101, 1, 1),
(1007, 102, 2, 2),
(1008, 103, 3, 3),
(1009, 104, 4, 4),
(1010, 105, 6, 5),
(1011, 106, 7, 6),
(1012, 101, 8, 1),
(1013, 102, 9, 2),
(1014, 103, 10, 3),
(1015, 104, 11, 4),
(1016, 105, 12, 5),
(1017, 106, 13, 6),
(1018, 101, 14, 1),
(1019, 102, 15, 2),
(1020, 103, 16, 3),
(1021, 104, 17, 4),
(1022, 105, 18, 5),
(1023, 106, 19, 6);

INSERT INTO RESSUPRIMENTO (ID_TAREFA, ID_LOJA, ID_PRODUTO) VALUES 
(1001, 101, 5001),
(1006, 101, 5010),
(1012, 101, 5012),
(1026, 101, 5010); /* presumo que esta tabela tenha que ter apenas tarefas de ressuprimento(tipo = 1 na tabela TAREFA), inseri de forma manual*/ 

INSERT INTO TAREFA (ID_TAREFA, ID_LOJA, ID_USUARIO, SITUACAO, TIPO) VALUES
(1026, 101, 1, 1, 1),
(1027, 102, 2, 2, 2),
(1028, 103, 3, 3, 3),
(1029, 104, 4, 4, 4),
(1030, 105, 5, 5, 5),
(1031, 106, 6, 6, 6),
(1032, 101, 1, 7, 7),
(1033, 102, 2, 8, 8),
(1034, 103, 3, 9, 9),
(1035, 104, 4, 10, 10);

INSERT INTO HISTORICO (ID_TAREFA, ID_LOJA, TIPO, ID_USUARIO) VALUES
(1026, 101, 1, 1),
(1027, 102, 2, 2),
(1028, 103, 3, 3),
(1029, 104, 4, 4),
(1030, 105, 6, 5),
(1031, 106, 7, 6),
(1032, 101, 8, 1),
(1033, 102, 9, 2),
(1034, 103, 10, 3),
(1035, 104, 11, 4),
(1026, 101, 12, 1),
(1027, 102, 13, 2),
(1028, 103, 14, 3),
(1029, 104, 15, 4),
(1030, 105, 16, 5),
(1031, 106, 17, 6),
(1032, 101, 18, 1),
(1033, 102, 19, 2); 

